<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Party Pixels – Reaction Speed Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="pp-main.css">

  <style>
    /* --- SPECYFICZNE DLA TEJ STRONY --- */

    /* Tło tylko dla tej gry */
  body.toy-bg-reaction {
    background: url("media/web-toy-card-default-thumb.jpg")
                center / cover fixed no-repeat #000;
    /* żadnych blendów, żadnych gradientów */
    background-color: rgba(0, 0, 0, 0.55); /* przyciemnienie */
  background-blend-mode: multiply;       /* miesza tło z czernią */
  }

  /* Wyłącz globalne splash tło z body::before na tej stronie */
  body.toy-bg-reaction::before {
    content: none;
  }

    .rs-container {
      max-width: 600px;
      margin: 30px auto;
      padding: 20px;
      text-align: center;
    }

    /* SCORE NA GÓRZE */
    #rs-score {
      font-size: 1.6rem;
      margin-bottom: 8px;
      font-weight: 700;
      color: #fff;
    }

    #rs-best {
      font-size: 1rem;
      opacity: 0.7;
      margin-bottom: 24px;
      color: #b8c0ff;
    }

    /* WIELKI PRZYCISK NA DOLE EKRANU */
    .rs-box {
      width: 100%;
      height: 320px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      font-weight: 600;
      cursor: pointer;
      user-select: none;
      transition: background 0.25s ease, color 0.25s ease;
      margin-top: 30px;
    }

    .rs-waiting {
      background: #2c2c45;
      color: #d0d0ff;
    }

    .rs-ready {
      background: #8f2b2b;
      color: #ffdede;
    }

    .rs-click {
      background: #2b8f3e;
      color: #eaffea;
    }

    /* Restart */
    #rs-restart {
      margin-top: 20px;
      padding: 10px 22px;
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      background: #6e63ff;
      color: white;
      transition: opacity 0.2s;
    }

    #rs-restart:hover {
      opacity: 0.8;
    }

  </style>
</head>
<body class="toy-bg-reaction">
  <div class="page">

    <!-- Header -->
    <div id="header"></div>

    <!-- CONTENT -->
    <div class="rs-container">

      <!-- SCORE u góry -->
      <div id="rs-score">—</div>
      <div id="rs-best">Your best: —</div>

      <!-- PRZYCISK GRY NA DOLE -->
      <div id="rs-box" class="rs-box rs-waiting">
        Tap to start
      </div>

      <button id="rs-restart">Restart</button>

    </div>

    <div id="tipjar"></div>

  </div>

  <!-- Header Loader -->
  <script>
  fetch("/header.html")
    .then(r => r.text())
    .then(t => document.getElementById("header").innerHTML = t)
    .catch(e => console.error("Header load error:", e));
  </script>

  <!-- TipJar Loader -->
  <script src="/tipjar.js"></script>

  <!-- GAME LOGIC -->
  <script>
    const box = document.getElementById("rs-box");
    const scoreOut = document.getElementById("rs-score");
    const bestOut = document.getElementById("rs-best");
    const restart = document.getElementById("rs-restart");

    let waiting = true;
    let ready = false;
    let startTime = 0;
    let timeout = null;

    let best = localStorage.getItem("rs-best") || null;
    if (best) bestOut.textContent = "Your best: " + best + " ms";

    function startGame() {
      box.textContent = "Wait for green…";
      box.className = "rs-box rs-ready";
      waiting = false;
      ready = false;

      const delay = Math.random() * 2000 + 800;

      timeout = setTimeout(() => {
        box.className = "rs-box rs-click";
        box.textContent = "TAP!";
        ready = true;
        startTime = performance.now();
      }, delay);
    }

    function resetToWaiting() {
      box.className = "rs-box rs-waiting";
      box.textContent = "Tap to start";
      waiting = true;
      ready = false;
      clearTimeout(timeout);
    }

    box.addEventListener("click", () => {
      if (waiting) {
        startGame();
        return;
      }

      if (!ready) {
        scoreOut.textContent = "Too early!";
        resetToWaiting();
        return;
      }

      const end = performance.now();
      const reaction = Math.floor(end - startTime);
      scoreOut.textContent = `Reaction: ${reaction} ms`;

      if (!best || reaction < Number(best)) {
        best = reaction;
        localStorage.setItem("rs-best", best);
        bestOut.textContent = "Your best: " + best + " ms";
      }

      resetToWaiting();
    });

    restart.addEventListener("click", resetToWaiting);
  </script>

</body>
</html>
